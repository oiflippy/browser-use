(()=>{"use strict";const e={};chrome.runtime.onMessage.addListener(((e,s,t)=>{if(!s.tab)return;const o=s.tab.id;return"DOM_UPDATE"===e.type?(console.log(`接收到来自标签页 ${o} 的DOM更新`),t({success:!0})):"ACTION_REQUEST"===e.type&&(console.log(`接收到来自标签页 ${o} 的动作请求:`,e.action),t({success:!0})),!0})),chrome.tabs.onUpdated.addListener(((s,t,o)=>{"complete"===t.status&&o.url&&(e[s]={isActive:!0,url:o.url,title:o.title||""},chrome.tabs.sendMessage(s,{type:"PAGE_LOADED"}).catch((e=>{console.log(`无法向标签页 ${s} 发送消息:`,e)})))})),chrome.tabs.onRemoved.addListener((s=>{e[s]&&delete e[s]})),chrome.tabs.onActivated.addListener((({tabId:s})=>{Object.keys(e).forEach((s=>{const t=parseInt(s);e[t]&&(e[t].isActive=!1)})),e[s]&&(e[s].isActive=!0)})),chrome.runtime.onInstalled.addListener((e=>{"install"===e.reason?(console.log("Browser Use 扩展已安装"),chrome.tabs.create({url:"https://docs.browser-use.com"})):"update"===e.reason&&console.log("Browser Use 扩展已更新到版本:",chrome.runtime.getManifest().version)})),console.log("Browser Use 扩展后台服务已启动")})();